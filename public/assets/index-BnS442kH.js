import{ai as _,ah as t,av as $,aw as C,a as f}from"./index-WozvSfaz.js";import{V as O,h as M,W as B,K as F,P as N,v as W,s as L,X as z,Y as K,k as Y,Z as q,_ as H}from"./ErpApp-AJk95zmD.js";import{ax as U,aL as V,aM as X,B as I,aS as Z}from"./IdurarOs-2Q7XqIs7.js";import{e as i}from"./actions-iFxDMtyd.js";import{e as G,f as J}from"./selectors-wTqr4dM2.js";import{F as Q}from"./FilePdfOutlined-QGwmh4Wx.js";function ee({config:l}){const r=$(),{ADD_NEW_ENTITY:n,entity:s}=l,c=()=>{r(`/${s.toLowerCase()}/create`)};return t.jsx(I,{onClick:c,type:"primary",icon:t.jsx(Y,{}),children:n})}function te({config:l,extra:r=[]}){const n=U();let{entity:s,dataTableColumns:c,disableAdd:u=!1,searchConfig:a}=l;const{DATATABLE_TITLE:h}=l,{result:y,isLoading:b}=_(G),{pagination:g,items:j}=y,{erpContextAction:m}=O(),{modal:k}=m,D=[{label:n("Show"),key:"read",icon:t.jsx(V,{})},{label:n("Edit"),key:"edit",icon:t.jsx(X,{})},{label:n("Download"),key:"download",icon:t.jsx(Q,{})},...r,{type:"divider"},{label:n("Delete"),key:"delete",icon:t.jsx(M,{})}],x=$(),E=e=>{p(i.currentItem({data:e})),x(`/${s}/read/${e._id}`)},d=e=>{const o={...e};p(i.currentAction({actionType:"update",data:o})),x(`/${s}/update/${e._id}`)},w=e=>{window.open(`${Z}${s}/${s}-${e._id}.pdf`,"_blank")},S=e=>{p(i.currentAction({actionType:"delete",data:e})),k.open()},v=e=>{p(i.currentItem({data:e})),x(`/invoice/pay/${e._id}`)};c=[...c,{title:"",key:"action",fixed:"right",render:(e,o)=>t.jsx(B,{menu:{items:D,onClick:({key:A})=>{switch(A){case"read":E(o);break;case"edit":d(o);break;case"download":w(o);break;case"delete":S(o);break;case"recordPayment":v(o);break}}},trigger:["click"],children:t.jsx(F,{style:{cursor:"pointer",fontSize:"24px"},onClick:A=>A.preventDefault()})})}];const p=C(),T=e=>{const o={page:e.current||1,items:e.pageSize||10};p(i.list({entity:s,options:o}))},R=()=>{p(i.list({entity:s}))};f.useEffect(()=>{const e=new AbortController;return R(),()=>{e.abort()}},[]);const P=e=>{const o={equal:e,filter:a==null?void 0:a.entity};p(i.list({entity:s,options:o}))};return t.jsxs(t.Fragment,{children:[t.jsx(N,{title:h,ghost:!0,extra:[t.jsx(W,{entity:a==null?void 0:a.entity,displayLabels:["name"],searchFields:"name",onChange:P},`${L.generate()}`),t.jsx(I,{onClick:T,icon:t.jsx(z,{}),children:n("Refresh")},`${L.generate()}`),!u&&t.jsx(ee,{config:l},`${L.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(K,{columns:c,rowKey:e=>e._id,dataSource:j,pagination:g,loading:b,onChange:T,scroll:{x:!0}})]})}function se({config:l}){let{entity:r,deleteModalLabels:n,deleteMessage:s="Do you want delete : ",modalTitle:c="Remove Item"}=l;const u=C(),{current:a,isLoading:h,isSuccess:y}=_(J),{state:b,erpContextAction:g}=O(),{deleteModal:j}=b,{modal:m}=g,[k,D]=f.useState("");f.useEffect(()=>{if(y){m.close();const d={page:1,items:10};u(i.list({entity:r,options:d}))}if(a){let d=n.map(w=>q(a,w)).join(" ");D(d)}},[y,a]);const x=()=>{const d=a._id;u(i.delete({entity:r,id:d})),m.close()},E=()=>{h||m.close()};return t.jsx(H,{title:c,open:j.isOpen,onOk:x,onCancel:E,confirmLoading:h,children:t.jsxs("p",{children:[s,k]})})}function re({config:l,extra:r}){const n=C(),{state:s}=O(),{deleteModal:c}=s,u=()=>{n(i.resetState())};return f.useLayoutEffect(()=>{const a=new AbortController;return u(),()=>{a.abort()}},[]),t.jsxs(t.Fragment,{children:[t.jsx(te,{config:l,extra:r}),t.jsx(se,{config:l,isOpen:c.isOpen})]})}export{re as E};

import{a as y,h as q,ah as e,aw as v,ai as _}from"./index-WozvSfaz.js";import{A as z,ax as b,aE as l,as as I,q as L,C as M,aF as N,B as x,aJ as V,aA as Z,ah as $,aM as J,aV as W,aH as O,aI as F}from"./IdurarOs-2Q7XqIs7.js";import{n as f,z as H,E as B,b as T,m as w,c as h,F as G,e as K,f as Q,D as X,g as ee,h as te,R as se,j as ae,k as ne,T as le}from"./ErpApp-AJk95zmD.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"};const re=oe;var de=function(n,s){return y.createElement(z,q({},n,{ref:s,icon:re}))};const ie=y.forwardRef(de);function U({isUpdateForm:t=!1,isForAdminOwner:n=!1}){const s=b();return e.jsxs(e.Fragment,{children:[e.jsx(l.Item,{label:s("first Name"),name:"name",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(l.Item,{label:s("last Name"),name:"surname",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(l.Item,{label:s("email"),name:"email",rules:[{required:!0},{type:"email"}],children:e.jsx(I,{autoComplete:"off"})}),!t&&e.jsx(l.Item,{label:s("Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(l.Item,{label:s("Role"),name:"role",rules:[{required:!0}],children:e.jsxs(f,{children:[e.jsx(f.Option,{value:"owner",disabled:!n,children:s("Account owner")}),e.jsx(f.Option,{value:"admin",disabled:n,children:s("super_admin")}),e.jsx(f.Option,{value:"manager",disabled:n,children:s("manager")}),e.jsx(f.Option,{value:"employee",disabled:n,children:s("employee")}),e.jsx(f.Option,{value:"create_only",disabled:n,children:s("create_only")}),e.jsx(f.Option,{value:"read_only",disabled:n,children:s("read_only")})]})}),e.jsx(l.Item,{label:s("enabled"),name:"enabled",valuePropName:"checked",initialValue:!0,children:e.jsx(H,{checkedChildren:e.jsx(L,{}),unCheckedChildren:e.jsx(M,{})})})]})}function ce({config:t,formElements:n,withUpload:s=!1}){let{entity:o}=t;const u=b(),i=v(),{current:r,isLoading:m,isSuccess:c}=_(B),{state:d,crudContextAction:p}=T(),{panel:j,collapsedBox:S,readBox:g}=p,k=()=>{g.open()},[E,D]=y.useState(!1),[C]=l.useForm(),P=a=>{const Y=r._id;a.file&&s&&(a.file=a.file[0].originFileObj),i(h.update({entity:o,id:Y,jsonData:a,withUpload:s}))};y.useEffect(()=>{if(r){let a={...r};a.birthday&&(a={...a,birthday:w(a.birthday).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.date&&(a={...a,date:w(a.date).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.expiredDate&&(a={...a,expiredDate:w(a.expiredDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.created&&(a={...a,created:w(a.created).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),a.updated&&(a={...a,updated:w(a.updated).format("YYYY-MM-DDTHH:mm:ss.SSSZ")});const Y=r.role==="owner";D(Y),C.resetFields(),C.setFieldsValue(a)}},[r]),y.useEffect(()=>{c&&(g.open(),S.open(),j.open(),C.resetFields(),i(h.resetAction({actionType:"update"})),i(h.list({entity:o})))},[c]);const{isEditBoxOpen:A}=d,R=A?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:R,children:e.jsx(N,{isLoading:m,children:e.jsxs(l,{form:C,layout:"vertical",onFinish:P,children:[e.jsx(U,{isUpdateForm:!0,isForAdminOwner:E}),e.jsx(l.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(x,{type:"primary",htmlType:"submit",children:u("Save")})}),e.jsx(l.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(x,{onClick:k,children:u("Cancel")})})]})})})}function ue({config:t}){const n=b();return e.jsx(G,{config:t,extra:[{label:n("Update Password"),key:"updatePassword",icon:e.jsx(ie,{})}]})}function me({config:t}){const n=b(),s=v(),{current:o}=_(B),{state:u,crudContextAction:i}=T(),[r]=l.useForm(),{onFetch:m,result:c,isLoading:d,isSuccess:p}=V(),j=D=>{const C="admin/password-update/"+o._id,A=(async()=>await Z.patch({entity:C,jsonData:D}))();m(A)},{readBox:S}=i,g=()=>{S.open()};y.useEffect(()=>{p&&(r.resetFields(),s(h.resetAction({actionType:"update"})))},[p]);const{isAdvancedBoxOpen:k}=u,E=k?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:E,children:e.jsxs(N,{isLoading:d,children:[e.jsx("h3",{children:n("Update Password")}),e.jsx("div",{className:"space10"}),e.jsxs(l,{form:r,layout:"vertical",onFinish:j,children:[e.jsx(l.Item,{label:n("New Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(l.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(x,{type:"primary",htmlType:"submit",children:n("Save")})}),e.jsx(l.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(x,{onClick:g,children:n("Cancel")})})]})]})})}function pe({config:t,formElements:n}){const s=b(),{crudContextAction:o}=T(),{advancedBox:u,modal:i,editBox:r}=o,{result:m}=_(ee),c=v(),d=()=>{c(h.currentAction({actionType:"delete",data:m})),i.open()},p=()=>{c(h.currentAction({actionType:"update",data:m})),r.open()},j=()=>{c(h.currentAction({actionType:"update",data:m})),u.open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space20"}),e.jsxs($,{children:[e.jsx(x,{onClick:d,type:"text",icon:e.jsx(te,{}),size:"small",children:s("remove")}),e.jsx(x,{onClick:p,type:"text",icon:e.jsx(J,{}),size:"small",children:s("edit")}),e.jsx(x,{onClick:j,type:"text",icon:e.jsx(W,{}),size:"small",children:s("Update Password")})]}),e.jsx("div",{className:"space20"}),e.jsx(se,{config:t}),e.jsx(ce,{config:t,formElements:n,withUpload:!0}),e.jsx(me,{config:t})]})}function xe({config:t}){console.log(t);const{crudContextAction:n}=T(),{collapsedBox:s}=n,o=()=>{s.close()};return e.jsxs(e.Fragment,{children:[e.jsx(O,{gutter:12,children:e.jsx(F,{className:"gutter-row",span:24,children:e.jsx("h1",{style:{fontSize:20,marginBottom:20},children:t.PANEL_TITLE})})}),e.jsxs(O,{gutter:8,children:[e.jsx(F,{className:"gutter-row",span:21,children:e.jsx(ae,{config:t})}),e.jsx(F,{className:"gutter-row",span:3,children:e.jsx(x,{onClick:o,block:!0,icon:e.jsx(ne,{})})})]})]})}function he({config:t,createForm:n,updateForm:s}){const o=v();return y.useLayoutEffect(()=>{o(h.resetState())},[]),e.jsxs(K,{config:t,fixHeaderPanel:e.jsx(xe,{config:t}),sidePanelBottomContent:e.jsx(Q,{config:t,formElements:n,withUpload:!0}),sidePanelTopContent:e.jsx(pe,{config:t,formElements:s}),children:[e.jsx(ue,{config:t}),e.jsx(X,{config:t})]})}const je={owner:"gold",admin:"magenta",manager:"purple",employee:"blue",create_only:"green",read_only:null};function be(){const t=b(),n="admin",s={displayLabels:["name","surname"],searchFields:"email,name,surname",outputValue:"_id"},o=["email"],u=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"}],i=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role",render:(d,p)=>{const j=d==="owner"?"Account owner":d==="admin"?"super admin":d;return e.jsx(le,{color:je[d],children:t(j)})}},{title:t("enabled"),dataIndex:"enabled",onCell:()=>({props:{style:{width:"60px"}}}),render:(d,p)=>e.jsx(H,{checked:d,checkedChildren:e.jsx(L,{}),unCheckedChildren:e.jsx(M,{})})}],r={PANEL_TITLE:t("admin"),DATATABLE_TITLE:t("admin_list"),ADD_NEW_ENTITY:t("add_new_admin"),ENTITY_NAME:t("admin"),RECORD_ENTITY:t("record_payment")},c={...{entity:n,...r},readColumns:u,dataTableColumns:i,searchConfig:s,deleteModalLabels:o};return e.jsx(he,{createForm:e.jsx(U,{}),config:c})}export{be as default};

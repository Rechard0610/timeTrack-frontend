import{aw as E,av as P,a as l,ai as D,ah as t}from"./index-WozvSfaz.js";import{t as O,$ as A,P as B,T as I,s as j,k as N}from"./ErpApp-AJk95zmD.js";import{ax as b,aE as S,B as v,aK as H,aF as K}from"./IdurarOs-2Q7XqIs7.js";import{e as T}from"./actions-iFxDMtyd.js";import{g as R}from"./selectors-wTqr4dM2.js";import{c as r}from"./calculate-XppRVO1U.js";import{C as _}from"./CloseCircleOutlined--Y-SA1pW.js";function z({form:u}){const f=b(),o=()=>{u.submit()};return t.jsx(v,{onClick:o,type:"primary",icon:t.jsx(N,{}),children:f("Save")})}function Y({config:u,CreateForm:f}){const o=b(),n=E(),p=P();l.useEffect(()=>{n(O.list({entity:"setting"})),n(A.list())},[]);let{entity:i}=u;const{isLoading:F,isSuccess:h,result:L}=D(R),[m]=S.useForm(),[$,y]=l.useState(0),[w,C]=l.useState(0),k=(a,c)=>{const s=c.items;let d=0,g=0;s&&(s.map(e=>{if(e){if(e.offerPrice&&e.quantity){let x=r.multiply(e.quantity,e.offerPrice);g=r.add(g,x)}if(e.quantity&&e.price){let x=r.multiply(e.quantity,e.price);d=r.add(d,x)}}}),y(d),C(g))};l.useEffect(()=>(h&&(m.resetFields(),n(T.resetAction({actionType:"create"})),y(0),C(0),p(`/${i.toLowerCase()}/read/${L._id}`)),()=>{}),[h]);const q=a=>{if(console.log("ðŸš€ ~ onSubmit ~ fieldsValue:",a),a&&a.items){let c=[...a.items];c.map(s=>{s.total=r.multiply(s.quantity,s.price)}),a={...a,items:c}}n(T.create({entity:i,jsonData:a}))};return t.jsxs(t.Fragment,{children:[t.jsx(B,{onBack:()=>{p(`/${i.toLowerCase()}`)},title:o("New"),ghost:!1,tags:t.jsx(I,{children:o("Draft")}),extra:[t.jsx(v,{onClick:()=>p(`/${i.toLowerCase()}`),icon:t.jsx(_,{}),children:o("Cancel")},`${j.generate()}`),t.jsx(z,{form:m},`${j.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(H,{dashed:!0}),t.jsx(K,{isLoading:F,children:t.jsx(S,{form:m,layout:"vertical",onFinish:q,onValuesChange:k,children:t.jsx(f,{subTotal:$,offerTotal:w})})})]})}export{Y as C};
